{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://docs.derivacloud.org/schemas/foreign_key.schema.json",
  "title": "tag:isrd.isi.edu,2016:foreign-key",
  "description": "Schema document for the 'foreign-key' annotation.",
  "definitions": {

    "display-option": {
      "type": "object",
      "properties": {
        "column_order": {
          "oneOf": [
            { "type": "boolean", "const": false },
            {
              "type": "array",
              "items": { "$ref": "#/definitions/sort-key" },
              "minItems": 1
            }
          ]
        },
        "show_foreign_key_link": {
          "type": "boolean"
        }
      },
      "additionalProperties": false
    },

    "sort-key": {
      "$comment": "A sort key can be either a column name or an object with column and descending (boolean)",
      "oneOf": [
        { "$ref": "#/definitions/column-name" },
        {
          "type": "object",
          "properties": {
            "column": {
              "$ref": "#/definitions/column-name"
            },
            "descending": {
              "type": "boolean",
              "default": false
            }
          },
          "required": ["column"],
          "additionalProperties": false
        }
      ]
    },

    "column-name": {
      "type": "string",
      "validate-model": true
    }

  },
  "type": "object",
  "properties": {
    "from_name": { "type": "string" },
    "to_name": { "type": "string" },
    "display": {
      "type": "object",
      "patternProperties": {
        "^[*]$|^compact([/]select|[/]brief([/]inline)?)?$|^detailed$": {
          "$ref": "#/definitions/display-option"
        }
      },
      "additionalProperties": false
    },
    "domain_filter_pattern": { "type": "string" }
  }
}
